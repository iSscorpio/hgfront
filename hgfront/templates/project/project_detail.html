{% extends "project/project_list.html" %}

{% block title %}{{block.super}} Project details for {{project.name_long}} ({{project.name_short}}){% endblock %}

{% block content_title %}Project Details{% endblock %}
{% block breadcrumbs %}{{block.super}} &gt; <a href="{{project.get_absolute_url}}">{{project.name_long}}</a>{% endblock %}

{% block main_content %}
	{% if permissions.view_project %}
	<dl class="project-details">
		<dt>
			<h3>{{project.name_long}}</h3>
		</dt>
		<dd>
			<h4>Project Description:</h4>
			{{project.description_long}}<br />
		</dd>
		<dd>
			<h4>Project Owner:</h4>
			<a href="{{project.user_owner.get_absolute_url}}">{{project.user_owner}}</a>
		</dd>
        <dd>
            <h4>Issues:</h4>
            {% if permissions.view_issues %}
                {% if project.issue_set.all %}
                    <table>
                        <thead>
                            <tr>
                                <th>Title</th>
                                <th>Created by</th>
                            </tr>
                        </thead>
                        <tbody>
                        {% for issue in issues %}
                            <tr>
                                <td><a href="{{issue.get_absolute_url}}">{{issue.title}}</a></td>
                                <td><a href="{{issue.user_posted.get_absolute_url}}">{{issue.user_posted.username}}</a></td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <a href="{% url issue-list project.name_short %}">view all issues for this project</a>
                {% else %}
                    This project has no issues, yay!
                {% endif %}
            {% else %}
                You can't view the issues, man!
            {% endif %}
        </dd>
	</dl>
	{% else %}
		<div class="error">
			<h2>This project is private, and cannot be viewed except for project members</h2>
		</div>
	{% endif %}
{% endblock %}

{% block sidebar %}
    {% if project.members %}
    <span class="group">Project Members</span>
        <ul>
        {% for member in project.members %}
            <li><a href="{{member.get_absolute_url}}">{{member.username}}</a></li>
        {% endfor %}
        </ul>
    {% endif %}
            
    {% if project.repo_set.all %}
        <span class="group">Project Repositories</span>
        <ul>
        {% for repo in project.repo_set.all %}
            <li><a href="{{repo.get_absolute_url}}">{{repo.repo_name}}</a></li>
        {% endfor %}
        </ul>
    {% endif %}
	<span class="group">Your Options for {{project.name_long}}</span>
		<ul>
			{% ifequal permissions.add_repos 1 %} 
        		<li><a href="{% url repo-create project.name_short %}">Create New Repo</a></li>
    		{% endifequal %}
			{% ifequal permissions.add_issues 1 %} 
        		<li><a href="{% url issue-create project.name_short %}">Create New Issue</a></li>
    		{% endifequal %}
        </ul>
{% endblock %}
